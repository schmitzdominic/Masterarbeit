(function(a){a.fn.ihkmobilesubnavigation=function(y){var J="url";var B="baseUrl";var j="mainNavToggle";var Q={CMChannel:"channel",CMArticle:"article",CMDocument:"document"};var ae=a.extend({},a.fn.ihkmobilesubnavigation.defaults,y);ae.data=this.data();var I=N(),L=true,ag=1,m=a(this),W=null,ad=null,K=null,i=null,F=null,T=null,O=null,Z=null,H=null,n=null,x=null,aa=false,C=false,d=false;ac();function ac(){C=r();if(C){a("body").addClass("is-articlepage");m.css({display:"none"})}ah();if(I&&I.length){h()}else{L=false}}function r(){var ai=false;if(a(".page-wrapper").hasClass("one-sidebar")){ai=true}return ai}function h(){var ai=U(ag,I[ag-1]);ai=ai[0];a(ai).trigger("click")}function w(){if(ag<I.length){ag++;h()}else{L=false;setTimeout(function(){ah()},400)}}function e(){if(!m.hasClass("is-active")){m.css({display:"block"});m.attr("aria-expanded","true");a(".lvl-1").attr("aria-expanded","true")}else{m.attr("aria-expanded","false");a(".lvl-1").attr("aria-expanded","false");a(".breadcrumb-item > a").attr("aria-expanded","false")}m.toggleClass("is-active")}function P(){ad=m.find("li.channel");ad.on("click keydown",t)}function ah(){W=a(ae[j])[0];ad=m.find("li.channel");ad.on("click keydown",t);K=m.find(".js-openclose");K.on("click keydown",c);i=m.find(".pane.category h2>a");i.on("click keydown",c);F=m.find(".pane:not(.category) h2>a");F.on("click keydown",v);a(window).on("keydown",p);a(".nav.main").on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",l)}function p(aj){var ai=aj.keyCode;if(ai&&ai!==9){return}setTimeout(function(){var ak=a(":focus");console.log(ak);console.log(ak.parents("#navigation").length)},100)}function l(){d=false;if(C){if(m.hasClass("is-active")){a(m).css({display:"block"})}else{a(m).css({display:"none"})}}}function k(){a(W).off("click",ab);ad.off("click keydown",t);K.off("click keydown",c);i.off("click keydown",c);F.off("click keydown",v)}function ab(){if(!a(W).hasClass("active")){m.removeClass("is-active");X()}}function af(ai){I=getParamArrayByString(ai.state);if(I&&I.length){isUserInteraction=false;h()}}function c(ak){var aj=ak.keyCode;if(aj&&aj!==13){return}if(ak){ak.preventDefault()}if(d){return}d=true;O=a(this);n=O.parents(".pane").data("lvl");k();e();if(!m.hasClass("is-active")){var ai=a(".pane");ai.attr("aria-expanded","false");z();setTimeout(function(){a(".pane-scrollwrapper").scrollTop(0)},400);if(n>1){setTimeout(function(){X()},400)}}else{q()}setTimeout(function(){ah()},400)}function z(){a("html, .body").removeClass("noscroll")}function q(){a("html, .body").addClass("noscroll")}function X(){m.addClass("is-resetting");m.animate({left:0},400,function(){m.removeClass("is-resetting")})}function v(al){var ak=al.keyCode;if(ak&&ak!==13){return}al.preventDefault();aa=true;a(".menu a").attr("aria-expanded","false");if(!R(al)){return false}O=a(this);n=O.parents(".pane").data("lvl");H=n-1;var ai=a(O).text();var aj=a(O).attr("href");A(ai,aj);k();b();ah();n=H;setTimeout(function(){aa=false},1000)}function E(ai){H=ai;k();b();ah();n=H}function t(al){var ak=al.keyCode;if(ak&&ak!==13){return}al.preventDefault();if(!R(al)){return false}O=a(this);Z=O.parents(".pane");n=Z.data("lvl");H=n+1;T=m.find(".lvl-"+H);x=ae.data[B]+O.data(J);var ai=a(O).find("a").text();var aj=a(O).find("a").attr("href");a(".menu a").attr("aria-expanded","false");O.find("a").attr("aria-expanded","true");A(ai,aj);k();D();S()}function A(ai,aj){history.pushState({navLevel:H},ai,aj)}function o(){history.back()}function S(){M(x).done(function(ai){var aj=g(ai);G(aj);m.css({display:"block"});m.addClass("is-active");b();if(L){P();w()}else{setTimeout(function(){ah()},400)}})}function G(ai){T.replaceWith(ai)}function b(){var ak=a(".lvl-"+H);ak.addClass("is-active");ak.find("ul").addClass("is-active");var ai=a(".pane");ai.attr("aria-expanded","false");ak.attr("aria-expanded","true");var aj=ak.find("h2 a")[0];a(aj).trigger("focus");var al=-(H-1)*100+"vw";m.css({left:al})}function g(ao){var ar=ao.items,aj=a("<div>").addClass("pane lvl-"+H+" content").attr("data-lvl",H),ak=a("<div>").addClass("pane-content"),aq=a("<h2>").addClass("mobileOnly"),al=a("<a>").text(ao.title).attr("href",f(H)).attr("data-url",ao.url),ai=a("<button>").addClass("js-openclose"),am=a("<div>").addClass("pane-scrollwrapper"),an=a("<ul>").addClass("menu");var ap=null;a.each(ar,function(ay,at){if(at.linktype=="document"){var ax=a("<li>").addClass("document");var aC=a("<a>").addClass("menu-download").attr("onmousedown",at.trackCode).attr("href",at.url);var av=a("<span>").addClass("file-name").html(at.title);var aA=a("<span>").addClass("doc-type").html(at.doctype);aC.append(av);aC.append(aA);ax.append(aC);an.append(ax)}else{if(at.linktype=="external"){var au=a("<li>").addClass("document");var aB=a("<a>").addClass("external-link").attr("href",at.url).attr("target","_blank").attr("rel","noopener").attr("onmousedown",at.trackCode).html(at.title);au.append(aB);an.append(au)}else{if(at.linktype=="extranet"){var au=a("<li>").addClass("document");var aB=a("<a>").addClass("extranet").attr("href",at.url).html(at.title);au.append(aB);an.append(au)}else{if(at.linktype=="intranet"){var au=a("<li>").addClass("document");var aB=a("<a>").addClass("intranet").attr("href",at.url).html(at.title);au.append(aB);an.append(au)}else{var az=a("<li>").addClass(Q[at.type]).attr("data-id",at.contentId).attr("data-url",at.contentId),aw=a("<a>").addClass(at.linktype).attr("href",at.url).html(at.title);az.append(aw);an.append(az)}}}}ap=at});aq.append(al);aq.append(ai);am.append(an);ak.append(aq).append(am);aj.append(ak);return aj}function D(){O.addClass("loading")}function Y(){O.removeClass("loading")}function R(ak){var aj=true;if(!checkOnKeyDown(ak)){aj=false}var ai=a(ak.target).parents(".pane").data("lvl");if(ai>=ae.maxPanes){aj=false}return aj}function f(al){var ai=Math.max(1,al-1);var aj=m.find(".lvl-"+ai).find("h2>a").data("url");if(aj=="/"){var ak=location.href;aj=ak.slice(0,ak.indexOf("?"))}return aj}function N(){var aj=u("param");if(!aj){aj=a("#navigation").data("layer-param")}var ai=a("#navigationParam");if(ai.length>0&&ai[0].dataset&&ai[0].dataset.param){aj=ai[0].dataset.param}if(aj){aj=aj.split(",")}else{aj=""}return aj}function u(ai){ai=ai.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var ak=new RegExp("[\\?&]"+ai+"=([^&#]*)"),aj=ak.exec(location.search);return aj===null?"":decodeURIComponent(aj[1].replace(/\+/g," "))}function M(aj){var ai={};return a.ajax({url:aj,dataType:"json",type:"get",data:ai})}function s(ak,am){var al=m.find(".pane[data-lvl='"+ak+"']")[0];var ai=a(al).find(".pane-content a[href*="+am+"]")[0];var aj=a(ai).parent().data("url");return aj}function U(aj,al){var ak=m.find('.pane[data-lvl="'+aj+'"]')[0];var ai=a(ak).find(".pane-scrollwrapper a[href*="+al+"]")[0];return a(ai).parent()}function V(ai){if(ai[0]!==""){I=ai;ag=1;L=true;h()}else{i.trigger("click");d=false}}return{showLevel:V}};a.fn.ihkmobilesubnavigation.defaults={}}(jQuery));